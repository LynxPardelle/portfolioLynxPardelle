"use strict";(self.webpackChunkLynxPortfolio=self.webpackChunkLynxPortfolio||[]).push([[728],{3728:(U,d,n)=>{n.r(d),n.d(d,{AuthModule:()=>N});var g=n(6814),c=n(649),b=n(5861),v=n(8849),y=n(875),C=n(7825),w=n(3519),m=n.n(w),S=n(6085),t=n(5879),x=n(5852),A=n(9627),M=n(4437),L=n(7157),Z=n(4221),u=n(6223);function T(o,h){1&o&&(t.TgZ(0,"span",11),t._uU(1," El correo electr\xf3nico es obligatorio. "),t.qZA())}function J(o,h){1&o&&(t.TgZ(0,"span",11),t._uU(1," La contrase\xf1a es obligatoria. "),t.qZA())}function F(o,h){if(1&o){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onSubmit())}),t._uU(1," Login "),t.qZA()}}const Y=[{path:"",component:(()=>{class o{constructor(e,i,s,a,r,f,p){this._mainService=e,this._route=i,this._router=s,this._webService=a,this._befService=r,this._sharedService=f,this.store=p,this.user=new v.n5("","","",""),this.document="login.component.ts",this.customConsoleCSS="background-color: rgba(123,45,100,0.75); color: white; padding: 1em;",this.windowWidth=window.innerWidth,f.changeEmitted$.subscribe(l=>{if("object"==typeof l&&"login"!==l.from&&("login"===l.to||"all"===l.to))switch(l.property){case"identity":this.identity=l.thing;break;case"windowWidth":this.windowWidth=l.thing;break;case"onlyConsoleMessage":this._webService.consoleLog(l.thing,this.document+" 51",this.customConsoleCSS)}}),this.main$=p.select(y.U7),this.identity=this._mainService.getIdentity(),this._webService.consoleLog(this.identity,this.document+" 60",this.customConsoleCSS),this._sharedService.emitChange({from:"app",to:"all",property:"identity",thing:this.identity}),this.store.dispatch((0,C.L7)())}ngOnInit(){this._sharedService.emitChange({from:"login",to:"all",property:"onlyConsoleMessage",thing:"Data from login"}),this.getMain()}getMain(){this.main$.subscribe({next:e=>{void 0!==e&&(this.main=e,this.cssCreate())},error:e=>console.error(e)})}onSubmit(){var e=this;return(0,b.Z)(function*(){try{let i=yield e._mainService.login(e.user).toPromise();if(!i||!i.user)throw new Error("No se encontr\xf3 el usuario.");let s=yield e._mainService.login(e.user,!0).toPromise();if(!s||!s.token)throw new Error("No se pudo conseguir el token.");e.identity=i.user,e.store.dispatch((0,S.VC)({sesion:{active:!0,identity:e.identity}})),e._webService.consoleLog(e.identity,e.document+" 57",e.customConsoleCSS),e.token=s.token,e._webService.consoleLog(e.token,e.document+" 63",e.customConsoleCSS),localStorage.setItem("ILP",JSON.stringify(e.identity)),e._sharedService.emitChange({from:"login",to:"all",property:"identity",thing:e.identity}),localStorage.setItem("TLP",e.token),e._router.navigate(["/inicio"]),m().fire({title:"Usuario logueado correctamente",html:"El usuario se ha identificado correctamente.",icon:"success",customClass:{popup:"bef bef-bg-fullRed",title:"text-bg-whatsApp",closeButton:"bg-whatsApp",confirmButton:"bg-whatsApp"}})}catch(i){e._webService.consoleLog(i,e.document+" 59",e.customConsoleCSS),m().fire({title:"Usuario no logueado",html:"El usuario no se ha logueado correctamente. <br/> "+i.error.message,icon:"error",customClass:{popup:"bef bef-bg-fullRed",title:"text-titleM",closeButton:"bef bef-text-fullYellow",confirmButton:"bef bef-text-fullYellow"}})}})()}cssCreate(){this._befService.cssCreate()}static#t=this.\u0275fac=function(i){return new(i||o)(t.Y36(x.J),t.Y36(c.gz),t.Y36(c.F0),t.Y36(A.Q),t.Y36(M.A),t.Y36(L.F),t.Y36(Z.yh))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-login"]],decls:16,vars:5,consts:[[1,"w-75","bef","bef-wmx-350px","bef-wmn-275px","mx-auto","my-5","bef-boxShadow-0__0__5px__tdark__OPA__0_25","bef-rounded-30px","p-3"],[1,"text-center","bef","bef-text-tlight","my-3"],[1,"d-block","w-75","mx-auto","my-3"],["for","email",1,"bef","bef-text-tlight","mb-1","d-block"],["type","email","name","email","placeholder","Correo electr\xf3nico","required","",1,"w-100","bef","bef-text-tdark","bef-bg-tlight","bef-border-0",3,"ngModel","ngModelChange"],["email","ngModel"],["class","bef bef-text-tlight font-weight-bold",4,"ngIf"],["for","password",1,"bef","bef-text-tlight","mb-1","d-block"],["type","password","name","password","placeholder","Contrase\xf1a","required","",1,"w-100","bef","bef-text-tdark","bef-bg-tlight","bef-border-0",3,"ngModel","ngModelChange"],["password","ngModel"],["class","btn bef bef-btn-fullRed bef-text-tdark p-2 mx-auto my-5 d-block w-50",3,"click",4,"ngIf"],[1,"bef","bef-text-tlight","font-weight-bold"],[1,"btn","bef","bef-btn-fullRed","bef-text-tdark","p-2","mx-auto","my-5","d-block","w-50",3,"click"]],template:function(i,s){if(1&i&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2,"Login"),t.qZA(),t.TgZ(3,"div",2)(4,"label",3),t._uU(5,"Correo electr\xf3nico"),t.qZA(),t.TgZ(6,"input",4,5),t.NdJ("ngModelChange",function(r){return s.user.email=r}),t.qZA(),t.YNc(8,T,2,0,"span",6),t.qZA(),t.TgZ(9,"div",2)(10,"label",7),t._uU(11,"Contrase\xf1a"),t.qZA(),t.TgZ(12,"input",8,9),t.NdJ("ngModelChange",function(r){return s.user.password=r}),t.qZA(),t.YNc(14,J,2,0,"span",6),t.qZA(),t.YNc(15,F,2,0,"button",10),t.qZA()),2&i){const a=t.MAs(7),r=t.MAs(13);t.xp6(6),t.Q6J("ngModel",s.user.email),t.xp6(2),t.Q6J("ngIf",!a.valid&&a.touched),t.xp6(4),t.Q6J("ngModel",s.user.password),t.xp6(2),t.Q6J("ngIf",!r.valid&&r.touched),t.xp6(1),t.Q6J("ngIf",s.user.password.length>0&&s.user.email.length>0)}},dependencies:[g.O5,u.Fj,u.JJ,u.Q7,u.On]})}return o})()}];let k=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[c.Bz.forChild(Y),c.Bz]})}return o})();var I=n(5586);let N=(()=>{class o{static#t=this.\u0275fac=function(i){return new(i||o)};static#e=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[g.ez,k,I.m]})}return o})()}}]);