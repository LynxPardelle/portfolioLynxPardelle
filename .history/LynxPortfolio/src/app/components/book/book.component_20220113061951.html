<!-- Edit/Delete Buttons -->
<div
  class="position-fixed end-0 bef bef-z-15"
  *ngIf="identity && identity.role == 'ROLE_ADMIN'"
  [ngClass]="{
    'bef-top-150px': windowWidth < 767,
    'bef-top-15per': windowWidth >= 767
  }"
>
  <button
    *ngIf="edit === false"
    class="btn bef bef-btn-fullYellow bef-text-tdark mr-2"
    (click)="editChange()"
  >
    <svg
      width="1em"
      height="1em"
      viewBox="0 0 16 16"
      class="bi bi-pencil-square"
      fill="currentColor"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456l-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"
      />
      <path
        fill-rule="evenodd"
        d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"
      />
    </svg>
  </button>

  <button
    *ngIf="edit == true"
    class="btn bef bef-btn-fullYellow bef-text-tdark mr-2 font-weight-normal float-right"
    (click)="editChange()"
  >
    X
  </button>
</div>

<h2 class="text-center bef bef-my-3rem">Book</h2>

<section>
  <article
    ngxMasonryItem
    class="d-flex flex-wrap align-items-center mx-auto bef bef-w-95per p-1 my-3"
  >
    <ng-container *ngFor="let bookImg of bookImgs">
      <img
        *ngIf="
          bookImg &&
          bookImg.img &&
          bookImg.img.location &&
          bookImg.img.title &&
          bookImg.width
        "
        class="obj-fit-cover mx-auto p-1"
        src="{{ urlMain + 'get-file/' + bookImg.img.location }}"
        alt="{{ lang === 'es' ? bookImg.title : bookImg.titleEng }}"
        [ngClass]="{
          'col-1': bookImg.width < windowWidth / 12,
          'col-2':
            bookImg.width >= windowWidth / 12 &&
            bookImg.width < (windowWidth / 12) * 2,
          'col-3':
            bookImg.width >= (windowWidth / 12) * 2 &&
            bookImg.width < (windowWidth / 12) * 3,
          'col-4':
            bookImg.width >= (windowWidth / 12) * 3 &&
            bookImg.width < (windowWidth / 12) * 4,
          'col-5':
            bookImg.width >= (windowWidth / 12) * 4 &&
            bookImg.width < (windowWidth / 12) * 5,
          'col-6':
            bookImg.width >= (windowWidth / 12) * 5 &&
            bookImg.width < (windowWidth / 12) * 6,
          'col-7':
            bookImg.width >= (windowWidth / 12) * 6 &&
            bookImg.width < (windowWidth / 12) * 7,
          'col-8':
            bookImg.width >= (windowWidth / 12) * 7 &&
            bookImg.width < (windowWidth / 12) * 8,
          'col-9':
            bookImg.width >= (windowWidth / 12) * 8 &&
            bookImg.width < (windowWidth / 12) * 9,
          'col-10':
            bookImg.width >= (windowWidth / 12) * 9 &&
            bookImg.width < (windowWidth / 12) * 10,
          'col-11':
            bookImg.width >= (windowWidth / 12) * 10 &&
            bookImg.width < (windowWidth / 12) * 11,
          'col-12':
            bookImg.width >= (windowWidth / 12) * 11 &&
            bookImg.width < windowWidth,
          col: bookImg.width >= windowWidth
        }"
      />
    </ng-container>
  </article>
</section>

<section class="my-5 py-5" *ngIf="edit === true">
  <h2 class="text-center my-3">
    <ng-container
      *ngIf="bookImg._id && bookImg._id !== ''; else elseBookImgIdTemplate"
    >
      Edición
    </ng-container>
    <ng-template #elseBookImgIdTemplate> Creación </ng-template>
    de imagen de book
  </h2>

  <!-- Title Edit -->
  <div class="d-block w-75 mx-auto my-3">
    <label class="bef bef-text-tlight mb-1 d-block" for="title">Título</label>
    <input
      class="w-100 bef bef-text-tlight bef-bg-tdark border-0"
      type="text"
      name="title"
      #title="ngModel"
      [(ngModel)]="bookImg.title"
      placeholder="Título"
      required
    />
    <span
      class="bef bef-text-tlight font-weight-bold"
      *ngIf="!title.valid && title.touched"
    >
      El título es obligatorio.
    </span>
  </div>

  <!-- TitleEng Edit -->
  <div class="d-block w-75 mx-auto my-3">
    <label class="bef bef-text-tlight mb-1 d-block" for="titleEng"
      >Title(English)</label
    >
    <input
      class="w-100 bef bef-text-tlight bef-bg-tdark border-0"
      type="text"
      name="titleEng"
      #titleEng="ngModel"
      [(ngModel)]="bookImg.titleEng"
      placeholder="Title"
      required
    />
    <span
      class="bef bef-text-tlight font-weight-bold"
      *ngIf="!titleEng.valid && titleEng.touched"
    >
      The title(english) is required.
    </span>
  </div>

  <div
    *ngIf="
      (bookImg._id && bookImg._id !== '') ||
      (bookImg.title &&
        bookImg.title !== '' &&
        bookImg.titleEng &&
        bookImg.titleEng !== '')
    "
    class="my-5 d-flex flex-wrap justify-content-evenly"
  >
    <!-- img Upload -->
    <div class="m-3">
      <h3 class="bef bef-text-tlight text-center w-75 my-3 d-block mx-auto">
        Subida de imagen
      </h3>
      <img
        *ngIf="bookImg && bookImg.img && bookImg.img.location"
        class="bef bef-wmx-75per d-block mx-auto bef-hmx-25vh my-3"
        src="{{ urlMain + 'get-file/' + bookImg.img.location }}"
        alt="{{ lang === 'es' ? bookImg.title : bookImg.titleEng }}"
      />
      <app-file-uploader
        [type]="'main'"
        [typeMeta]="'one'"
        [typeThingComRes]="'book-img'"
        [thing]="bookImg.img"
        [thingInside]="true"
        [id]="bookImg._id"
        (pre_loader)="pre_load($event)"
        (recoverThing)="recoverThingFather($event)"
      ></app-file-uploader>
    </div>
  </div>

  <!-- Submit -->
  <button
    [disabled]="
      !bookImg._id ||
      bookImg._id === '' ||
      !bookImg.title ||
      bookImg.title === '' ||
      !bookImg.titleEng ||
      bookImg.titleEng === ''
    "
    (click)="onSubmit()"
    class="bef btn bef-btn-fullRed bef-text-tdark p-2 mx-auto my-5 d-block w-50"
  >
    Submit
  </button>
</section>

<!--
  [ngClass]="{
        'col-2': bookImg.width < (windowWidth / 12) * 2,
        'col-4':
          bookImg.width > (windowWidth / 12) * 2 &&
          bookImg.width < (windowWidth / 12) * 4,
        'col-6':
          bookImg.width > (windowWidth / 12) * 4 &&
          bookImg.width < (windowWidth / 12) * 6,
        'col-8':
          bookImg.width > (windowWidth / 12) * 6 &&
          bookImg.width < (windowWidth / 12) * 8,
        'col-10':
          bookImg.width > (windowWidth / 12) * 8 &&
          bookImg.width < (windowWidth / 12) * 10,
        'col-12':
          bookImg.width > (windowWidth / 12) * 10 && bookImg.width < windowWidth,
        col: bookImg.width > windowWidth
      }"
-->

<!--
  'col-1': bookImg.width < windowWidth / 12,
        'col-2':
          bookImg.width > windowWidth / 12 &&
          bookImg.width < (windowWidth / 12) * 2,
        'col-3':
          bookImg.width > (windowWidth / 12) * 2 &&
          bookImg.width < (windowWidth / 12) * 3,
        'col-4':
          bookImg.width > (windowWidth / 12) * 3 &&
          bookImg.width < (windowWidth / 12) * 4,
        'col-5':
          bookImg.width > (windowWidth / 12) * 4 &&
          bookImg.width < (windowWidth / 12) * 5,
        'col-6':
          bookImg.width > (windowWidth / 12) * 5 &&
          bookImg.width < (windowWidth / 12) * 6,
        'col-7':
          bookImg.width > (windowWidth / 12) * 6 &&
          bookImg.width < (windowWidth / 12) * 7,
        'col-8':
          bookImg.width > (windowWidth / 12) * 7 &&
          bookImg.width < (windowWidth / 12) * 8,
        'col-9':
          bookImg.width > (windowWidth / 12) * 10 &&
          bookImg.width < (windowWidth / 12) * 9,
        'col-10':
          bookImg.width > (windowWidth / 12) * 9 &&
          bookImg.width < (windowWidth / 12) * 10,
        'col-11':
          bookImg.width > (windowWidth / 12) * 10 &&
          bookImg.width < (windowWidth / 12) * 11,
        'col-12':
          bookImg.width > (windowWidth / 12) * 11 &&
          bookImg.width < windowWidth,
        col: bookImg.width > windowWidth
-->

<!--
  'col-4':
          bookImg.width < (windowWidth / 12) * 4,
        'col-8':
          bookImg.width > (windowWidth / 12) * 4 &&
          bookImg.width < (windowWidth / 12) * 8,
        'col-12':
          bookImg.width > (windowWidth / 12) * 8 &&
          bookImg.width < windowWidth,
        col: bookImg.width > windowWidth
-->
